<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.min.js"></script>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover">
    <meta name="description" content="Gift Checklist">
    <title>Gift checklist</title>
  </head>
  
  
  
 <style>
  body {
    font-family: "Helvetica Neue", Helvetica, sans-serif;
  }
   
  ul {
  	list-style-type: none;
    display: flex;
  }
 
  .container {
	  	flex-direction: column;
  }
   
  .item-list {
		 flex-direction: row;

  }
   
  .parent {
  	flex-direction: column;

  }

  .list-content {
  	flex-direction: row;
  }

  li {
  	
  }
   

  
   

</style>

  <body>
    
    
    
    <section class="bnr">
      <h1 class="page-heading"> Gift Registry </h1>
    </section>  
    
    <section class="login">
      <div class="loginpage">
        <label> User name:</label> <input id="username_field"/>
        <br>
        <label> Password:</label> <input id="password_field"/>
        <br>
        <button type="button" id="makeList">Make List</button>
      </div>
    </section>
    
    <section class="theList">
      <div class="list">

        <h2 class="list-heading"> Wish List </h2>

        <label> Item Name: </label> <input id="list_entry"/>
        <br>

        <form class="input list fields">
          <div>
            <label for="url"> Link: </label>
 	         	<input type="url" name="url" class="url">
          </div>
          <div>
            <label for="quantity"> Quantity: </label>
 	         	<input type="number" name="quantity" class="quantity">
          </div>
          <div>
            <label for="comments"> Comments: </label>
 	         	<input type="text" name="comments" class="comments">
          </div>
          <div>
          	<button class="addItemButton" type="button">Add</button>
          </div>
        </form>
        


        <div class="container">
        	<ul class="item-list"> 
            
          	<li class="parent">
              <input type= "checkbox" class="checked"> <a href="https://www.amazon.ca/pants">Pants</a>
            </li>
                <ul class="list-content"> 
                  <li>1</li>
                  <li>Medium, in black</li>
                </ul>
            
            
						<li class="parent">
              <input type= "checkbox" class="checked"><a href="https://www.amazon.ca/shirt">Shirt</a>
            </li>
                <ul class="list-content"> 
                  <li>6</li>
                  <li>Small</li>
                </ul>
            
          </ul>
        </div>
        
        
        
        
        
             

      </div> 
    </section>  
    
  </body>
 
 </html>
    
<script>
  // ------------ELEMENTS------------
  // Buttons
  const btnMakeList = document.querySelector('#makeList');
  const btnAddItemButton = document.querySelector('.addItemButton');  
  //const btnSubmitList = document.querySelector(--------SUBMIT BUTTON CLASS/ID HERE------)
  
  // Input Fields
  const usernameField = document.querySelector('#username_field');
	const passwordField = document.querySelector('#password_field');
  
	const itemNameField = document.querySelector('#list_entry');
	const itemLinkField = document.querySelector('.url');  
	const itemQuantityField = document.querySelector('.quantity');
	const itemCommentsField = document.querySelector('.comments');  
  
  
  // Page Sections
  const loginpage = document.querySelector('.loginpage');
  const listPage = document.querySelector('.thelist');
  
  const itemListContainer = document.querySelector('.item-List');
  
  
  // Wishlist Item Object
  const item1 = {
    name: "Shirt",
    link: "https://www.amazon.ca/shirt",
    quantity: 1,
    comments: "This is the comment: Medium, in black",
    checked: false,
  }
  const item2 = {
    name: "Pants",
    link: "https://www.amazon.ca/pants",
    quantity: 6,
    comments: "This is the comment: Small",
    checked: false,
  }
  
  // User object
  class User {
		constructor(username, password) {
      this.name = username;
      this.password = password;
      this.listArray = [];
  	}
  }
  
  class Item {
    constructor(itemName, itemLink, itemQuantity, itemComments) {
      this.name = itemName;
      this.link = itemLink;
      this.quantity = itemQuantity;
      this.comments = itemComments;
      this.checked = false;
    }
  }
    
	const user1 = {
    name: "John Smith",
    username: "jsmith",
    password: 1111,
    eventDate: "January 1st, 2022",
    listArray: [item1, item2],
  };
  
  const user2 = {
    name: "Tyler One",
    username: "tone",
    password: 2222,
    eventDate: "January 5th, 2022",
    listArray: [item1],
  };
  
  let accounts = [user1, user2];
  let currentAccount;
  
  // ------------FUNCTIONS------------
  const createNewAccount = function() {
    const user = new User(usernameField.value, Number(passwordField.value));
    currentAccount = user;
  };

	const checkUsername = function() {
    accounts.forEach(function(acc) {
     if(acc.username ===  usernameField.value && acc.password === Number(passwordField.value)) {
       // If valid username, change current account
			 currentAccount = acc;
       updateUI();
       window.alert(`Just logged in as ${currentAccount.name}`);
   		}
    });
     if (currentAccount == null) {
       // If invalid username, call create new account object
       window.alert('User not found, creating new user');
       createNewAccount();
       updateUI();
   	}
 };
  
  const populateItems = function() {
 		itemListContainer.innerHTML = '';
    currentAccount.listArray.forEach(function(item, i) {
    const html = `
								<li>
              <input type= "checkbox"> <a href="${item.link}">${item.name}</a>
            </li>
                <ul class="list-content"> 
                  <li>${item.quantity}</li>
                  <li>${item.comments}</li>
                </ul>
`
    itemListContainer.insertAdjacentHTML("beforeend",html); 
    });
  };
  
  const updateUI = function() {
   //populate the list items by forEach loop over currentUser 
   populateItems();
	 checkBoxUpdate();    
  }

  var checklist = document.getElementsByClassName("checked");
  user1.listArray[j].checked = true;
  
  const checkBoxUpdate = function() {
    var checklist = document.getElementsByClassName("checked");
    /*
    for (var j = 0; j < checklist.length; j++) {
       checklist[j].addEventListener('click', function() {
          if (checklist[j].checked) {
           currentAccount.listArray[j].checked = true;
         } else {
           currentAccount.listArray[j].checked = false;
         }
       });
  	}
    */
  }
  
  function isCheckedOff(e) {
    if (e.target.checked) {
           currentAccount.listArray[j].checked = true;
         } else {
           currentAccount.listArray[j].checked = false;
         }
  }
  
  //listPage.hidden = true;
  
  // ------------BUTTONS------------
  btnMakeList.addEventListener('click', function() {
    //Clear the current account
    currentAccount = null;
    //loginpage.hidden = true; 
    listPage.hidden = false;
    checkUsername();
  });
  
  
  btnAddItemButton.addEventListener('click', function() {
    const item = new Item(itemNameField.value, itemLinkField.value, Number(itemQuantityField.value), itemCommentsField.value)
    currentAccount.listArray.push(item);
    updateUI();
  });
  
  //btnCheckBox.addEventListener('click', function() {
   //whenever box is checked, change flag in object
    //updateUI
  //});

 /* 
  btnSubmitList.addEventListener('click', function() {
    accounts.push(currentAccount);
    currentAccount = null;
  });
  */
  
  
    
 
</script>
